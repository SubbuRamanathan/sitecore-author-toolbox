import*as global from"./modules/global.js";import{log,loadJsFile,getScItemData}from"./modules/helpers.js";import{initDarkMode,detectSwitchDarkMode}from"./modules/dark.js";import{addHelptextIcons}from"./modules/help.js";import{showSnackbar}from"./modules/snackbar.js";import{workboxNotifications}from"./modules/workbox.js";import{resumeFromWhereYouLeftOff,historyNavigation}from"./modules/history.js";import{checkNotificationPermissions,checkPublishNotification}from"./modules/notification.js";import{initFlagRibbonEE,initLanguageMenuEE,initLanguageMenuCE,initFlagsPublishingWindow,initFlagsPublish}from"./modules/language.js";import{initCharsCount,initCheckboxes,initDateTimeField,initPasswordField,refreshContentEditor,contentTreeScrollTo,keyEventListeners}from"./modules/contenteditor.js";import{initIntroScreen,initAppName,initGravatarImage,initUserMenu}from"./modules/users.js";import{initInstantSearch,enhancedSitecoreSearch}from"./modules/search.js";import{insertModal,insertPanel}from"./modules/insert.js";import{initMediaExplorer,initMediaCounter,initMediaDragDrop,initMediaViewButtons,initUploadButton,initUploader,initLightbox,initMediaSearchBox}from"./modules/media.js";import{initOnboarding,initExperimentalUi,initInsertIcon,initGutter,initSitecoreRibbon,initSvgAnimation,initSvgAnimationPublish,initEventListeners,initTitleBarDesktop,initMaterializeIcons}from"./modules/experimentalui.js";import{initFavorites}from"./modules/favorites.js";import{initGroupedErrors}from"./modules/errors.js";import{enhancedBucketLists}from"./modules/buckets.js";import{initRteTooltips,initSyntaxHighlighterRte}from"./modules/rte.js";import{initPreviewButton,listenPreviewTab}from"./modules/preview.js";import{initLaunchpadIcon,initLaunchpadMenu}from"./modules/launchpad.js";import{initAutoExpandTree,initTreeGutterTooltips}from"./modules/contenttree.js";import{initQuerySuggestions}from"./modules/template.js";import{initDefaultTextEE,storeCurrentPageEE,addToolbarEditCE,addToolbarTooltip,addPlaceholderTooltip,addHideRibbonButton,resetExperienceEditor,initRenderingSearchBox}from"./modules/experienceeditor.js";chrome.storage.sync.get(storage=>{if(global.isSitecore&&global.isSitecoreJs&&!global.isEditMode&&!global.isLoginPage&&!global.isCss){if(log("Sitecore detected","red"),document.body&&document.body.classList.add("satExtension"),loadJsFile("js/inject.js"),checkNotificationPermissions(),checkPublishNotification(storage),initAutoExpandTree(storage),keyEventListeners(),initUserMenu(storage),initDarkMode(storage),detectSwitchDarkMode(storage),global.isContentEditor){log("**** CE ****","yellow");let ScItem=getScItemData();initTreeGutterTooltips(),refreshContentEditor(storage),resumeFromWhereYouLeftOff(storage),initInstantSearch(storage),initFavorites(storage),workboxNotifications(storage),historyNavigation(),showSnackbar(storage),contentTreeScrollTo(),initLightbox(),initIntroScreen(),storage.feature_experimentalui&&(log("**** Experimental ****","yellow"),initAppName(storage,"Content Editor"),initSvgAnimation(storage),insertModal(storage,ScItem.id,ScItem.language,ScItem.version),insertPanel(),initInsertIcon(storage),initGutter(),initSitecoreRibbon(),initEventListeners(),initTitleBarDesktop(),initOnboarding(),initMaterializeIcons(storage))}if(global.isLaunchpad)log("**** Launchpad ****","orange"),initLaunchpadIcon(storage),workboxNotifications(storage),showSnackbar(storage),initIntroScreen();else if(!global.isDesktop||global.isGalleryFavorites||global.isXmlControl)if(global.isUserManager)log("**** User Manager ****","orange"),initAppName(storage,"User Manager");else if(global.isSecurityEditor)log("**** Security Editor ****","orange"),initAppName(storage,"Security Editor");else if(global.isAccessViewer)log("**** Access Viewer ****","orange"),initAppName(storage,"Access Viewer");else if(global.isDomainManager)log("**** Domain Manager ****","orange"),initAppName(storage,"Domain Manager");else if(global.isRoleManager)log("**** Role Manager ****","orange"),initAppName(storage,"Role Manager");else if(global.isPowerShellIse)log("**** PowerShell ISE ****","orange"),initAppName(storage,"PowerShell ISE");else if(global.isPowerShellReports)log("**** PowerShell Reports ****","orange"),initAppName(storage,"PowerShell Reports");else if(global.isRecycleBin)log("**** Recycle Bin ****","orange"),initAppName(storage,"Recycle Bin");else if(global.isWorkbox)log("**** Workbox ****","orange"),initAppName(storage,"Workbox");else if(global.isTemplateBuilder)log("**** Template Builder ****","orange"),initAppName(storage,"Template Builder"),initQuerySuggestions(storage);else{log("**** Non identified ****","green"),log(global.windowLocationHref,"green"),initExperimentalUi(storage);let appName=document.querySelector("*[data-sc-id=HeaderTitle]");appName=appName?appName.innerText:"",initAppName(storage,appName)}else log("**** Desktop Shell ****","orange"),initAppName(storage,"Sitecore Desktop"),initLaunchpadMenu(storage),workboxNotifications(storage),showSnackbar(storage);global.isPreviewTab?(log("**** Preview tab ****","orange"),initPreviewButton(storage),listenPreviewTab(storage)):global.isMediaFolder?(log("**** Media Folder ****","orange"),initMediaCounter(storage),initMediaDragDrop(storage),initMediaViewButtons(storage),initMediaExplorer(storage),initMediaSearchBox(storage),initMaterializeIcons(storage)):global.isFieldEditor?(log("**** Field editor ****","orange"),initCheckboxes(storage),initDateTimeField(storage),initPasswordField(storage),initCharsCount(storage),initGroupedErrors(storage),addHelptextIcons(),enhancedBucketLists(),initMaterializeIcons(storage)):global.isExperienceProfile?(log("**** Experience Profile ****","orange"),initGravatarImage(storage)):global.isRichTextEditor||global.isHtmlEditor?(log("**** Rich Text Editor ****","orange"),initRteTooltips(storage),initSyntaxHighlighterRte(storage)):global.isContentEditorApp&&storage.feature_experimentalui||global.isContentEditorApp&&storage.feature_instantsearch?(log("**** Content Editor App ****","orange"),document.querySelector("#globalLogo")&&document.querySelector("#globalLogo").setAttribute("target","_parent")):global.isSearch?(log("**** Internal Search ****","orange"),enhancedSitecoreSearch(storage)):global.isGalleryLanguage?(log("**** Languages menu ****","orange"),initLanguageMenuCE(storage)):global.isPublishDialog?(log("**** Publishing window ****","orange"),initFlagsPublishingWindow(storage)):global.isPublishWindow||global.isInstallationWizard?(log("**** Publish / Rebuild / Package ****","orange"),initCheckboxes(storage),initFlagsPublish(storage),initSvgAnimationPublish(storage)):global.isExportSiteWizard?(log("**** Export Site Wizard ****","orange"),initSvgAnimationPublish(storage)):global.isUploadPackage?(log("**** Upload Package ****","orange"),initSvgAnimationPublish(storage)):global.isUserOptions?(log("**** User options ****","orange"),document.querySelectorAll(".scTabs > div > fieldset > div").forEach((function(elem){"Quick info section"==elem.innerText&&elem.setAttribute("style","color:red; font-weight:bold"),"Item title bar"==elem.innerText&&elem.setAttribute("style","color:red; font-weight:bold")}))):global.isEditorFolder?(log("**** Editors folder ****","orange"),initMaterializeIcons(storage)):global.isGalleryVersion?log("**** Versions menu ****","orange"):global.isLayoutDetails?(log("**** Layout Details ****","orange"),initMaterializeIcons(storage)):global.isDialog||global.isLockedItems?(log("**** Dialog UI ****","orange"),initMaterializeIcons(storage),initUploader()):global.isGalleryFavorites?(log("**** Favorites ****","orange"),initMaterializeIcons(storage)):global.isMediaBrowser?(log("**** Media Browser ****","orange"),initUploadButton(storage)):global.isSelectRendering&&!global.isSourceBrowser?(log("**** Select Rendering ****","orange"),initAppName(storage,"Select Rendering"),initRenderingSearchBox(storage),initMaterializeIcons(storage)):global.isXmlControl&&!global.isRichText?(log("**** XML Control (Window) ****","orange"),initCheckboxes(storage),initDateTimeField(storage),initPasswordField(storage),initMaterializeIcons(storage)):global.isSourceBrowser?log("**** Source Browser ****","orange"):global.isGalleryLinks&&log("**** Links menu ****","orange")}(global.isEditMode&&!global.isLoginPage||global.isPreviewMode&&!global.isLoginPage||global.isSitecoreModule&&!global.isLoginPage)&&(log("Experience Editor detected","red"),document.body&&document.body.classList.add("satExtension"),loadJsFile("js/inject.js"),checkNotificationPermissions(),checkPublishNotification(storage),keyEventListeners(),initFlagRibbonEE(storage),initUserMenu(storage,"EE"),initDarkMode(storage),detectSwitchDarkMode(storage),global.isRibbon?(log("**** EE Ribbon ****","orange"),storeCurrentPageEE()):global.isGalleryLanguageExpEd?(log("**** Language Menu ****","orange"),initLanguageMenuEE(storage)):global.isGalleryVersionExpEd?log("**** Version Menu ****","orange"):global.isInsertPage?(log("**** Insert Page ****","orange"),initMaterializeIcons(storage)):global.isSitecoreModule?log("**** Sitecore Module ****","orange"):global.isDialogEE?log("**** Dialog ****","orange"):global.isNavigationTree?(log("**** Navigation Tree ****","orange"),initMaterializeIcons(storage)):(log("**** Website preview in EE ****","orange"),addToolbarEditCE(storage),addToolbarTooltip(storage),addPlaceholderTooltip(storage),addHideRibbonButton(storage),resetExperienceEditor(storage),initMaterializeIcons(storage),initDefaultTextEE(storage)))});