import*as global from"./global.js";import{getSiteUrl}from"./url.js";export{showSnackbar,showSnackbarSite};const showSnackbar=storage=>{let versionIncrement=Number(global.extensionVersion.split(".").pop()),hiddenIntroScreen,show=!0;if(localStorage.getItem("scIntroScreen")&&0==versionIncrement){let snackbarHtml,html=`<div class="snackbar">${`\n    <b>Welcome to Sitecore Author Toolbox ${global.extensionVersion}!</b><br />\n    Live URL is now compatible with multi-sites!<br />Click "INFO" to find out more!`}<button id="sbAction" onclick='javascript:window.open("https://uquaisse.io/extension-update/")'>INFO</button><button id="sbDismiss">DISMISS</button></div>`,parentSnackbar;!parent.document.querySelector(".snackbar")&&global.showSnackbar&&localStorage.getItem("sbDismiss")!=global.extensionVersion&&(document.querySelector("body").insertAdjacentHTML("beforeend",html),document.querySelectorAll("#sbAction, #sbDismiss").forEach((function(elem){elem.addEventListener("click",(function(){localStorage.setItem("sbDismiss",global.extensionVersion),document.querySelector(".snackbar").setAttribute("style","display: none")}))})))}},showSnackbarSite=(storage,ScItem)=>{let siteName=ScItem.pathFull.split("/home/")[0].split("/").reverse(),pathToHome=ScItem.pathFull.split("/home/")[0]+"/home/",ScSite,siteUrl=getSiteUrl(storage,pathToHome,ScItem.language).url,existing=localStorage.getItem("sbDismissSites");existing=existing?JSON.parse(existing):{};let length=Object.values(existing).length,snackbarHtml,html=`<div class="snackbarSite">${'<b>"'+siteName[0].toUpperCase()+'" site detected</b><br /> Are you using a CD server for publishing?<br />Click "Add site" to configure it now.'}<button id="sbActionSite" onclick="addSite('${global.launchpadPage}','${global.urlOrigin}','${pathToHome}', '${siteName[0].toUpperCase()}')">ADD&nbsp;SITE</button><button id="sbDismissSite">CLOSE</button></div>`;document.querySelectorAll(".snackbarSite").forEach(div=>{div.remove()}),ScItem.pathFull.includes("/home/")&&-1===Object.values(existing).indexOf(siteName[0].toUpperCase())&&null==siteUrl&&(document.querySelector("body").insertAdjacentHTML("beforeend",html),document.querySelectorAll("#sbDismissSite").forEach((function(elem){elem.addEventListener("click",(function(){existing[length++]=siteName[0].toUpperCase(),localStorage.setItem("sbDismissSites",JSON.stringify(existing)),document.querySelector(".snackbarSite").setAttribute("style","display: none")}))})))};